\chapter{Operaciones cuánticas} % {{{
\ccnote{prueba}
%Adoptando la descripción de estados cuánticos en términos de la matriz de 
%densidad $\rho$ podemos describir la dinámica de ellos como
%\begin{align*}
%	\rho '=\mathcal{E} (\rho).
%\end{align*}
%El mapeo $\mathcal{E}$ define a una operación cuántica. Esta es la 
%representación matemática de la evolución dinámica que ocurre como
%resultado de un proceso físico, $\rho$ es el estado inicial del 
%sistema y $\mathcal{E}(\rho)$ el estado final.
%
%Una manera natural de describir la dinámica de un sistema cuántico
%abierto es considerarlo que resulta de la interacción del sistema
%de interés, el sistema principal, y un entorno, que juntos forman
%un sistema cuántico cerrado. En general, el estado final 
%del sistema $\E (\rho)$ no está relacionado al estado inicial
%mediante una transformación unitaria. Vamos a asumir que
%el estado del sistema completo se encuentra en un estado
%producto, $\rho \otimes \sigma$, donde $\sigma$ es el 
%estado en el que se encuentra el entorno. Luego de la
%transformación $U$ el sistema ya no interactúa con el 
%entorno y por ello realizamos una operación de traza parcial sobre 
%el entorno para obtener el estado reducido del sistema principal:
%\begin{align}
%	\E (\rho) = \Tr _{env}\qty[U \qty(\rho \otimes \sigma)U^{\dagger}].
%	\label{eq:PTraceE(rho)}
%\end{align}
%Esta definición de operación cuántica puede tener problemas
%de generalidad dado que se hizo la suposición de que el 
%estado inicial del sistema total era un estado producto. En 
%general este no es el caso, sin embargo el formalismo de las 
%operaciones cuánticas describe también la dinámica cuántica
%de sistemas que no se encuentran inicialmente en un estado
%producto.
%
%Una definición más apropiada de las operaciones cuánticas es
%definirlo como la clase de mapeos que surgen como resultado de
%los siguientes procesos: algún sistema inicial se prepara en un
%estado cuántico desconocido $\rho$ y luego se pone en contacto
%con otros estados preparados en estados estándar, permitiendo 
%la interacción mediante alguna evolución unitaria y luego
%se desecha alguna parte del sistema total, dejando así 
%sólo al sistema final en algún estado $\rho'$. En conclusión, 
%una operación cuántica $\E$ es un mapeo de $\rho$ a $\rho'$.
%
%\section{Representación de suma de operadores}
%Las operaciones cuánticas se pueden representar de una manera
%conocida como la representación de operadores de suma. Esta
%representación es reescribir la ecuación \eqref{eq:PTraceE(rho)}
%en término de operadores que actúan sobre el sistema de Hilbert
%principal. EL resultado está motivado por el siguiente cálculo. 
%Supongamos que $\ket{e_k}$ es una base ortonormal para el
%espacio de estados del entorno y sea $\sigma = \dyad{e_0}{e_0}$
%el estado inicial del entorno. No hay perdida de generalidad si 
%asumimos que el entorno comienza en un estado producto. De 
%esta manera, la ecuación \eqref{eq:PTraceE(rho)} se convierte en
%\begin{align*}
%	\E (\rho) &= \sum _k \bra{e_k}U\qty[\rho \otimes \dyad{e_0}{e_0}]U^{\dagger}
%	\ket{e_0} \\
%						&= \sum _k E_k\rho E_k^{\dagger},
%\end{align*}
%donde $E_k\equiv \matrixel{e_k}{U}{e_k}$ es un operador que actúa
%sobre el espacio de estados del sistema principal. Los operadores
%$E_k$ se conocen como elementos de operación para la operación 
%cuántica $\E$. 
%
%\begin{align*}
%	1 &= \Tr \qty(\Erho) \\
%		&= \Tr \qty(\sum _k E_k\rho E_k^{\dagger}) \\
%		&= \Tr \qty(\sum _k E_k^{\dagger}E_k \rho),
%\end{align*}
%esto se debe cumplir para cualquier $\rho$, entonces 
%\begin{align}
%	\sum _k E_k^{\dagger}E_k = \mathbb{1}.
%\end{align}
%Esta ecuación la satisfacen las operaciones cuánticas que preservan
%la traza. No obstante, también existen operaciones cuánticas que 
%no preservan la traza, las cuales $\sum _kE_k^{\dagger}E_k\leq \mathbb{1}$,
%pero describen procesos en los que información extra sobre lo que ocurrió
%en el proceso se obtiene por medición. 
%
%La representación en operadores de suma es importante porque ofrece
%una manera intrínseca de caracterizar la dinámica del sistema principal. 
%Este formalismo describe la dinámica del sistema principal sin hacerse
%necesario considerar de manera explícita las propiedades del entorno. 
%Esto provee de implicaciones teóricas considerables. 
%
%\subsection{Enfoque axiomático}
%Ahora vamos a adoptar una ruta distinta para las operaciones cuánticas
%en la que vamos a intentar enunciar axiomas motivados físicamente que
%esperamos que cumplan las operaciones cuánticas. Esta ruta es por supuesto
%más abstracta que la anterior, pero es esta misma abstracción lo que hace
%este enfoque muy poderoso.
%
%Para proceder con este enfoque vamos a definir a las operaciones 
%cuánticas de acuerdo con un conjunto de axiomas justificados en
%bases físicas. Luego, vamos a probar que un mapeo $\E$ satisface
%estos axiomas si y sólo si tiene una representación de operadores
%de suma. De esta manera se provee del puente teórico entre 
%la formulación axiomática y la formulación motivada físicamente.
%
%Vamos definir una operación cuántica $\E$ como un mapeo del conjunto
%de los operadores de densidad del espacio de entrada $Q_1$ al 
%conjunto de los operadores de densidad del espacio de salida $Q_2$,
%con las siguientes tres propiedades axiomáticas:
%\begin{description}
%	\item[A1] \label{axiom1}
%	$\Tr \qty[\E (\rho)]$ es la probabilidad de que un proceso
%	representado por $\E$ suceda, cuando $\rho$ es el estado inicial. 
%	De esa manera, $0\leq \Tr \qty[\E (\rho)]\leq 1$ para cualquier
%	estado $\rho$.
%	\item[A2] $\E$ es un mapeo lineal convexo sobre el conjunto de las 
%	matrices de densidad. Es decir que, para un conjunto
%	de probabilidades $\{ p_i\}$,
%	\begin{align}
%		\E \qty(\sum _i p_i\rho_i) = \sum _i p_i \E \qty(\rho_i).
%		\label{eq:qtmOp-a2}
%	\end{align}
%	\item[A3] $\E$ es un mapeo completamente positivo. Es decir, si $\E$ 
%	mapea operadores de densidad del sistema $Q_1$ en operadores de
%	densidad del sistema $Q_2$, entonces $\E (A)$ debe de ser positivo
%	para cualquier operador $A$. Además, si se introduce un sistema
%	extra $R$ de dimensión arbitraria, debe ser cierto que $\qty(
%	\mathbb{1}\otimes \E)(A)$ es un operador positivo para cualquier
%	operador $A$ sobre el sistema combinado $RQ_1$, donde $\mathbb{1}$
%	denota el mapeo de la identidad sobre el sistema $R$.
%\end{description}
%
%Una operación cuántica física es aquella que satisface el 
%requisito de que las probabilidades nunca suman más de 1,
%$\Tr \qty[\E (\rho)]\leq 1$.
%
%La segunda propiedad proviene de un requisito físico sobre las
%operaciones cuánticas. Supongamos que la entrada $\rho$ de la 
%operación cuántica se obtiene aleatoriamente seleccionando un 
%estado del ensamble $\qty{ p_i,\rho_i}$ de estados cuánticos, 
%es decir que $\rho = \sum_i p_i\rho_i$. Entonces se espera que
%el estado resultante, $\E (\rho)/\Tr \qty[\E (\rho)] =
%\E (\rho)/p\qty(\E)$ corresponda a una selección aleatoria del
%ensamble $\qty{p\qty(i\vert\E), \E (\rho)/\Tr \qty[\E (\rho)]}$,
%donde $p\qty(i\vert\E)$ es la probabilidad de que el estado
%preparado fuese $\rho_i$, dado que el proceso representado por
%$\E$ ocurrió. De esa manera, se debe querir que
%\begin{align}
%	\E (\rho) = p\qty(\E)\sum _i p\qty(i\vert \E)\frac{\E (\rho)}
%	{\Tr \qty[\E (\rho)]},
%	\label{eq:e(rho)-bayes}
%\end{align}
%donde $p\qty(\E)=\Tr \qty[\E (\rho)]$ is la probabilidad de que 
%el proceso descrito por $\E$ suceda en alguna entrada de $\rho$.
%Por la regla de Bayes,
%\begin{align}
%	p\qty(i\vert \E)=p\qty(\E \vert i) \frac{p_i}{p\qty(\E)}
%	=\frac{\Tr \qty[\E (\rho)]p_i}{p\qty(\E)},
%\end{align}
%de manera que \eqref{eq:e(rho)-bayes} se reduce a \eqref{eq:qtmOp-a2}.
%
%La tercera propiedad se origina de que no sólo $\E (\rho)$ debe ser
%una matriz de densidad válida tanto cuánto $\rho$ sea válida, pero 
%además, si $\rho _{RQ}$ es la matriz de densidad de un sistema 
%de dos partes $R$ y $Q$, si $\E$ actúa sólamente sobre $Q$, 
%entonces $\E(\rho_{RQ})$ debe ser también una matriz de densidad 
%válida del sistema completo. Supongamos que introducimos un sistema 
%$R$ finito dimensional. Sea $\mathbb{1}$ el mapeo identidad sobre
%el sistema $R$. Entonces el mapeo $\mathbb{1}\otimes \E$ debe
%enviar operadores positivos hacia operadores positivos.
%
%El siguiente teorema establece la equivalencia entre este enfoque 
%axiomático y los modelos de sistema-entorno y la representación
%de operadores de suma con el que se comenzó
%la discusión de las operaciones cuánticas:
%\begin{teorema}
%	El mapeo $\E$ satisface los axiomas \textbf{A1}, \textbf{A2} y 
%	\textbf{A3} si y sólo si
%	\begin{align}
%		\E(\rho) = \sum _i E_i\rho E_i^{\dagger},
%	\end{align}
%	para algún conjunto de operadores $\qty{E_i}$ que mapean el espacio
%	de Hilbert de entrada hacia el espacio de Hilbert de salida, y
%	$\sum _kE_k^{\dagger}E_k\leq \mathbb{1}$.
%\end{teorema}

- Introducción hablando de que las operaciones cuánticas sirven 
para describir la dinámica de los sistemas abiertos y una guía al 
lector de qué se viene en este cap. Enfatizar en que el truco es 
considerar como 'nuevo sistema cerrado' al sistema extendido
\cpnote{No entiendo esa frase}
\janote{Me refiero a que un sistema que interactúa con su entorno es abierto, 
pero si consideramos al sistema total (principal+entorno) ese es cerrado.
\textbf{Ahora que lo expliqué ya no encuentro sentido para hablar de esto aquí,
mejor lo voy a quitar}}
\section{Mapeos completamente positivos}
%\janote{
%Introducir la transformación de la matriz de densidad $\rho$ y hablar
%de que $\E$ transforma estados en estados.}
%
%\janote{
%    - Motivación de la CP. Ejemplo del mapeo que deforma la esfera de Bloch
%    en un disco: presentar que el mapeo extendido para 2 qubits
%    aplicado al estado máximamente entrelazado resulta en una matriz 
%    no positiva (algo que no es estado).}

La completa positividad es una condición que deben satisfacer las operaciones
cuánticas para representar una evolución física 
\cite{bengtsson_zyczkowski_2017}. Esta condición es
intrínseca de la dinámica de los sistemas cuánticos abiertos, dada la 
posibilidad de un sistema cuántico a interaccionar con su entorno. A
continuación, vamos a presentar un ejemplo que justificará la condición
de completa positividad de las operaciones cuánticas y, seguidamente,
vamos a finalizar con la definición precisa de esta condición.

En el formalismo de las operaciones cuánticas, un estado cuántico
descrito por su operador de densidad $\rho$
se transforma según la ecuación \cite{nielsen_chuang_2011}
%\janote{Arreglar, muy de putazo escupo la transformación}
\begin{align}
\rho' = \E (\rho)
\label{eq:E(rho)},
\end{align} 
donde $\E$ es una operación cuántica que representa alguna evolución 
física y $\rho'$ es el estado que resulta de la evolución. 
En el capítulo anterior hemos 
establecido dos ejemplos de operaciones cuánticas, la evolución unitaria 
y la medición del estado de un sistema, 
para los cuales $\E \qty(\rho)=U\rho U^{\dagger}$ y 
$\E(\rho)=M\rho M^{\dagger}$, respectivamente. 
Una operación cuántica proporciona
una descripción discreta del cambio dinámico que un estado cuántico 
atraviesa durante un proceso físico. Una operación cuántica $\E$ es
una transformación lineal que mapea matrices de densidad en matrices 
de densidad \cite{bengtsson_zyczkowski_2017}. Surge entonces la siguiente
pergunte, ¿ser un mapeo afín es
suficiente para asegurar que $\E$ representa una operación física?
A continuación veremos que no.  Para que $\E$ sea una operación física 
debe ser un mapeo afín de operadores de densidad 
y satisfacer la condición de completa positividad. Esta condición
adicional surge como consecuencia del acoplo que el sistema de estudio
pueda tener con un entorno del cual podríamos o no tener acceso a sus
grados de libertad.


Veamos a continuación un ejemplo de una operación que actúa sobre 
un sistema de 1 qubit; y luego, al considerar la misma operación, pero en 
el espacio extendido de 2 qubits, sobre
el estado máximamente entrelazado, 
el resultado de la operación será algo que no es un estado cuántico. 
De esta manera, quedará claro la razón para exigir la condición de 
completa positividad para que una operación cuántica 
represente a un proceso físico.
Consideremos un 1 qubit, un sistema cuántico
de dos niveles, cuya matriz de densidad se puede representar como
\cite{nielsen_chuang_2011}
\begin{align}
\rho=\frac{\1+\vec{r}\cdot\vec{\sigma}}{2},
\label{eq:DM-1q}
\end{align}
donde $\vec{\sigma}$ es un vector con las matrices de Pauli 
en sus entradas y $\vec{r}$
el vector de Bloch ($\abs{\vec{r}}\leq1$). Esta representación
de la matriz de densidad nos permite asociar a cada punto en la 
esfera unitaria con un estado de 1 qubit, como se muestra en la parte
izquierda de \Fref{fig:qtm-op-motivation}. Los estados puros se corresponden
con puntos en la superficie de la esfera y los estados mixtos 
con puntos en el interior, incluyendo al origen.
Ahora consideremos la operación $\E_z$ que deforma la bola de Bloch a un 
disco sobre el plano XY, como se muestra en la \Fref{fig:qtm-op-motivation}. 
La acción de la operación $\E_z$ sobre una matriz de densidad
de la forma \eqref{eq:DM-1q} es transformar al vector de Bloch $\vec{r}$
como $\qty(r_1,r_2,r_3)\mapsto\qty(r_1,r_2,0)$.
\begin{figure}[H]
\centering
\begin{minipage}{.4\textwidth}
\centering
\includegraphics[width=5cm]
{img-congreso/bloch.png}
\end{minipage}
$\stackrel{\E_{z}\otimes\1 \vspace{1cm}}{\longmapsto}$
\begin{minipage}{0.4\textwidth}
\centering
\includegraphics[width=6cm]
{img-congreso/DiskXY}
\end{minipage}
\caption{Deformación de la esfera de Bloch a un disco sobre el plano $XY$.}
\label{fig:qtm-op-motivation}
\end{figure}
Por otro lado, el estado máximente entralazado $\rho^{\phi}$ de 
un sistema de 2 qubits es \cite{bengtsson_zyczkowski_2017}
\begin{align}
\rho^{\phi}&=
\mqty( 
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
).
\label{eq:DM-2q-MaxE}
\end{align}
Siguiendo la representación de la matriz de densidad de 1 qubit,
la matriz de densidad de 2 qubits se puede escribir como
\begin{align}
\rho&=\frac{1}{4}\sum _{i,j=0}^{3}r_{ij}\sigma_i\otimes\sigma_j,
\label{eq:DM-2q}
\end{align}
donde $\sigma_0=\1$ y $\vec{r}$ es un vector de 16 entradas que contiene
la información física local de cada qubit y las correlaciones del sistema.
%\janote{por qué se iguala?}
Se igualan \eqref{eq:DM-2q-MaxE} y \eqref{eq:DM-2q} para encontrar
el estado máximamente entrelazado en la representación de \eqref{eq:DM-2q}. 
Se obtiene que $r_{00}=r_{11}=r_{33}=1$, $r_{22}=-1$, y el resto de 
componentes en $\vec{r}$ son iguales a cero. 

Ahora consideremos la operación $\E_z\otimes\1$ que borra
la componente en $z$ del primer qubit y deja invariante 
al segundo qubit. La acción de esta operación es equivalente 
a transformar el vector $\vec{r}$ de $\rho^{\phi}$, en la representación
de \eqref{eq:DM-2q}, como
\begin{align}
\qty(1,0,0,0,0,1,0,0,0,0,-1,0,0,0,0,1)
\longmapsto
\qty(1,0,0,0,0,1,0,0,0,0,-1,0,0,0,0,0).
\end{align}
Por consiguiente, la matriz de densidad $\rho^{\phi}$ se transforma 
ante la operación $\E_z\otimes\1$ como
\begin{align}
\mqty( 
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
)
%\E\otimes\1\qty(\rho^{\phi})&=
\stackrel{\E_{z}\otimes\1}{\longmapsto}
\mqty( 
\frac{1}{4} & 0 & 0 & \frac{1}{2} \\
0 & \frac{1}{4} & 0 & 0 \\
0 & 0 & \frac{1}{4} & 0 \\
\frac{1}{2} & 0 & 0 & \frac{1}{4} \\
).
\end{align}
La matriz $\E_z\otimes\1\qty(\rho^{\phi})$ tiene un autovalor igual a $-1/4$.
Por consiguiente, $\E_z\otimes\1\qty(\rho^{\phi})$ no es una matriz 
de densidad. Dicho de otro modo, $\E_z\otimes\1\qty(\rho^{\phi})$ 
no describe a algún estado físico de un sistema de 2 qubits.
En resumen, hemos probado que la operación $\E_z$ que deforma la bola 
de Bloch a un disco sobre el plano $XY$, cuando se considera su 
extensión sobre el espacio de 2 qubits $\E_z\otimes\1$ y se aplica al
estado máximamente entrelazado da como resultado un estado no físico. 
En consecuencia, $\E_z$ no representa ninguna evolución física. Este 
resultado deja en evidencia que una operación cuántica debe ser 
un mapeo afín de estados cuánticos, de un sistema que se compone del
sistema principal y otro secundario, sin importar la dimensión del
espacio secundario.

%\janote{- Definición de CP del Geometry of Quantum States.}

Revisemos ahora la definición formal de completa positividad.
Una operación $\E$ se dice que es completamente positiva (CP)
si y sólo si, para cualquier extensión dimensional arbitraria $K$ 
del espacio de Hilbert, tal que 
$\hi_N \rightarrow \hi_N \otimes \hi_K$,
el operador $\E\otimes\1_K$ es positivo semidefinido 
\cite{bengtsson_zyczkowski_2017}. Esta es la última condición 
necesaria de imponer sobre las operaciones cuánticas para 
que sean transformaciones de estados físicos. 

%\janote{- Concluir con que las operaciones que estudiamos deben ser CPTP.}

En conclusión, una operación cuántica es una mapeo afín de 
operadores de densidad que es completamente positivo. 
En la literatura se suele hacer una diferencia entre operaciones cuánticas
y canales cuánticos \cite{weedbrook2012gaussian}, el término operaciones 
cuánticas se utiliza para operaciones que, en general, disminuyen la traza 
del operador de densidad, y canales cuánticos es exclusivo para operaciones 
que preservan la traza del operador de densitad (operaciones CPTP). En 
este proyecto estamos interesados en estudiar las operaciones CPTP. 
En las siguientes dos secciones vamos a presentar dos representaciones
distintas de las operaciones CPTP. 



\section{Superoperadores}
\janote{Propongo agregar esta sección por la línea que quiero seguir 
durante todo el capítulo. Además que si menciono la representación en 
suma de operadores, por qué no la de superoperadores?  es la que he 
usado para la parte numérica}

%- Empezar hablando del reshape a $\rho$ (pasarlo de matriz a vector columna)
Consideremos una matriz rectangular $A$ de dimensión $M\times N$.
La matriz puede ser reordenada colocando sus elementos de matriz en 
orden lexicográfico en un vector $\vec{a}$ con $MN$ entradas, es decir
\begin{align}
a_k=A_{ij}, 
\end{align}
donde $k=\qty(i-1)N+j$, con $i=,1,\ldots,M$ y $j=1,\ldots,N$.

La transformación de \textit{reshuffle} de una matriz consiste 
en reordenar cada fila de la matriz en submatrices y colocarlas en 
orden lexicográfico bloque por bloque. Veamos un ejemplo a continuación
\begin{align}
\mqty(
A_{00}&A_{01}&A_{02}&A_{03}\\
A_{10}&A_{11}&A_{12}&A_{13}\\
A_{20}&A_{21}&A_{22}&A_{23}\\
A_{30}&A_{31}&A_{32}&A_{33})
\stackrel{R}{\longrightarrow}
\mqty(
A_{00}&A_{01}&A_{10}&A_{11}\\
A_{02}&A_{03}&A_{12}&A_{13}\\
A_{20}&A_{21}&A_{30}&A_{31}\\
A_{22}&A_{23}&A_{32}&A_{33}).
\end{align}

\janote{Hablar de los mapeos que actúan sobre $\rho$ como un vector columna}

\janote{
- Hablar de la matriz de Choi y enunciar el teorema de Choi: si la matriz
 de Choi es positiva semidefinida entonces la operación cuántica es CP
}

\janote{
- Concluir con un ejemplo de un canal nuestro sobre 1 qubit
}
\section{Representación de suma de operadores}
- Enunciar la representación en operadores de suma partiendo de un 
estado que se acopla con algún entorno
y llegar a las condiciones para ser CPTP y empezar a conectarlo
con la sección anterior. \cpnote{No sabes si hay alguna motivacion que no sea
con el entorno? Realmente no lo usamos y se me hace meter una complicación adicional}
\janote{Podría utilizar el segundo item de este cap. como motivación. Creo
que esto sí lo usamos. David revisó unas cosas así (o mencionó que quería
hacerlo)}

- Invocar el ejemplo del canal de la sección anterior, pero en su 
representación de operadores de suma. Aquí quiero hacer la conexión 
entre esta y la sección anterior mostrando que los operadores 
de Kraus son los autovectores de la matriz de Choi. 

- Comparar la representacion de suma de operadores y superoperadores


\section{Canales cuánticos de 1 qubit}
- Hablar de que se gana intuición pensando en la acción de un canal de 1
qubit como la manera en que deforma la esfera de Bloch

- Ejemplos: phase-flip channel, depolarizing y amplitude damping 

- De los ejemplos hablar sobre canales unitales? Breve. (es que nuestros
canales son unitales)

% }}}

