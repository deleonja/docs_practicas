\chapter{Operaciones cuánticas} % {{{
%Adoptando la descripción de estados cuánticos en términos de la matriz de 
%densidad $\rho$ podemos describir la dinámica de ellos como
%\begin{align*}
%	\rho '=\mathcal{E} (\rho).
%\end{align*}
%El mapeo $\mathcal{E}$ define a una operación cuántica. Esta es la 
%representación matemática de la evolución dinámica que ocurre como
%resultado de un proceso físico, $\rho$ es el estado inicial del 
%sistema y $\mathcal{E}(\rho)$ el estado final.
%
%Una manera natural de describir la dinámica de un sistema cuántico
%abierto es considerarlo que resulta de la interacción del sistema
%de interés, el sistema principal, y un entorno, que juntos forman
%un sistema cuántico cerrado. En general, el estado final 
%del sistema $\E (\rho)$ no está relacionado al estado inicial
%mediante una transformación unitaria. Vamos a asumir que
%el estado del sistema completo se encuentra en un estado
%producto, $\rho \otimes \sigma$, donde $\sigma$ es el 
%estado en el que se encuentra el entorno. Luego de la
%transformación $U$ el sistema ya no interactúa con el 
%entorno y por ello realizamos una operación de traza parcial sobre 
%el entorno para obtener el estado reducido del sistema principal:
%\begin{align}
%	\E (\rho) = \Tr _{env}\qty[U \qty(\rho \otimes \sigma)U^{\dagger}].
%	\label{eq:PTraceE(rho)}
%\end{align}
%Esta definición de operación cuántica puede tener problemas
%de generalidad dado que se hizo la suposición de que el 
%estado inicial del sistema total era un estado producto. En 
%general este no es el caso, sin embargo el formalismo de las 
%operaciones cuánticas describe también la dinámica cuántica
%de sistemas que no se encuentran inicialmente en un estado
%producto.
%
%Una definición más apropiada de las operaciones cuánticas es
%definirlo como la clase de mapeos que surgen como resultado de
%los siguientes procesos: algún sistema inicial se prepara en un
%estado cuántico desconocido $\rho$ y luego se pone en contacto
%con otros estados preparados en estados estándar, permitiendo 
%la interacción mediante alguna evolución unitaria y luego
%se desecha alguna parte del sistema total, dejando así 
%sólo al sistema final en algún estado $\rho'$. En conclusión, 
%una operación cuántica $\E$ es un mapeo de $\rho$ a $\rho'$.
%
%\section{Representación de suma de operadores}
%Las operaciones cuánticas se pueden representar de una manera
%conocida como la representación de operadores de suma. Esta
%representación es reescribir la ecuación \eqref{eq:PTraceE(rho)}
%en término de operadores que actúan sobre el sistema de Hilbert
%principal. EL resultado está motivado por el siguiente cálculo. 
%Supongamos que $\ket{e_k}$ es una base ortonormal para el
%espacio de estados del entorno y sea $\sigma = \dyad{e_0}{e_0}$
%el estado inicial del entorno. No hay perdida de generalidad si 
%asumimos que el entorno comienza en un estado producto. De 
%esta manera, la ecuación \eqref{eq:PTraceE(rho)} se convierte en
%\begin{align*}
%	\E (\rho) &= \sum _k \bra{e_k}U\qty[\rho \otimes \dyad{e_0}{e_0}]U^{\dagger}
%	\ket{e_0} \\
%						&= \sum _k E_k\rho E_k^{\dagger},
%\end{align*}
%donde $E_k\equiv \matrixel{e_k}{U}{e_k}$ es un operador que actúa
%sobre el espacio de estados del sistema principal. Los operadores
%$E_k$ se conocen como elementos de operación para la operación 
%cuántica $\E$. 
%
%\begin{align*}
%	1 &= \Tr \qty(\Erho) \\
%		&= \Tr \qty(\sum _k E_k\rho E_k^{\dagger}) \\
%		&= \Tr \qty(\sum _k E_k^{\dagger}E_k \rho),
%\end{align*}
%esto se debe cumplir para cualquier $\rho$, entonces 
%\begin{align}
%	\sum _k E_k^{\dagger}E_k = \mathbb{1}.
%\end{align}
%Esta ecuación la satisfacen las operaciones cuánticas que preservan
%la traza. No obstante, también existen operaciones cuánticas que 
%no preservan la traza, las cuales $\sum _kE_k^{\dagger}E_k\leq \mathbb{1}$,
%pero describen procesos en los que información extra sobre lo que ocurrió
%en el proceso se obtiene por medición. 
%
%La representación en operadores de suma es importante porque ofrece
%una manera intrínseca de caracterizar la dinámica del sistema principal. 
%Este formalismo describe la dinámica del sistema principal sin hacerse
%necesario considerar de manera explícita las propiedades del entorno. 
%Esto provee de implicaciones teóricas considerables. 
%
%\subsection{Enfoque axiomático}
%Ahora vamos a adoptar una ruta distinta para las operaciones cuánticas
%en la que vamos a intentar enunciar axiomas motivados físicamente que
%esperamos que cumplan las operaciones cuánticas. Esta ruta es por supuesto
%más abstracta que la anterior, pero es esta misma abstracción lo que hace
%este enfoque muy poderoso.
%
%Para proceder con este enfoque vamos a definir a las operaciones 
%cuánticas de acuerdo con un conjunto de axiomas justificados en
%bases físicas. Luego, vamos a probar que un mapeo $\E$ satisface
%estos axiomas si y sólo si tiene una representación de operadores
%de suma. De esta manera se provee del puente teórico entre 
%la formulación axiomática y la formulación motivada físicamente.
%
%Vamos definir una operación cuántica $\E$ como un mapeo del conjunto
%de los operadores de densidad del espacio de entrada $Q_1$ al 
%conjunto de los operadores de densidad del espacio de salida $Q_2$,
%con las siguientes tres propiedades axiomáticas:
%\begin{description}
%	\item[A1] \label{axiom1}
%	$\Tr \qty[\E (\rho)]$ es la probabilidad de que un proceso
%	representado por $\E$ suceda, cuando $\rho$ es el estado inicial. 
%	De esa manera, $0\leq \Tr \qty[\E (\rho)]\leq 1$ para cualquier
%	estado $\rho$.
%	\item[A2] $\E$ es un mapeo lineal convexo sobre el conjunto de las 
%	matrices de densidad. Es decir que, para un conjunto
%	de probabilidades $\{ p_i\}$,
%	\begin{align}
%		\E \qty(\sum _i p_i\rho_i) = \sum _i p_i \E \qty(\rho_i).
%		\label{eq:qtmOp-a2}
%	\end{align}
%	\item[A3] $\E$ es un mapeo completamente positivo. Es decir, si $\E$ 
%	mapea operadores de densidad del sistema $Q_1$ en operadores de
%	densidad del sistema $Q_2$, entonces $\E (A)$ debe de ser positivo
%	para cualquier operador $A$. Además, si se introduce un sistema
%	extra $R$ de dimensión arbitraria, debe ser cierto que $\qty(
%	\mathbb{1}\otimes \E)(A)$ es un operador positivo para cualquier
%	operador $A$ sobre el sistema combinado $RQ_1$, donde $\mathbb{1}$
%	denota el mapeo de la identidad sobre el sistema $R$.
%\end{description}
%
%Una operación cuántica física es aquella que satisface el 
%requisito de que las probabilidades nunca suman más de 1,
%$\Tr \qty[\E (\rho)]\leq 1$.
%
%La segunda propiedad proviene de un requisito físico sobre las
%operaciones cuánticas. Supongamos que la entrada $\rho$ de la 
%operación cuántica se obtiene aleatoriamente seleccionando un 
%estado del ensamble $\qty{ p_i,\rho_i}$ de estados cuánticos, 
%es decir que $\rho = \sum_i p_i\rho_i$. Entonces se espera que
%el estado resultante, $\E (\rho)/\Tr \qty[\E (\rho)] =
%\E (\rho)/p\qty(\E)$ corresponda a una selección aleatoria del
%ensamble $\qty{p\qty(i\vert\E), \E (\rho)/\Tr \qty[\E (\rho)]}$,
%donde $p\qty(i\vert\E)$ es la probabilidad de que el estado
%preparado fuese $\rho_i$, dado que el proceso representado por
%$\E$ ocurrió. De esa manera, se debe querir que
%\begin{align}
%	\E (\rho) = p\qty(\E)\sum _i p\qty(i\vert \E)\frac{\E (\rho)}
%	{\Tr \qty[\E (\rho)]},
%	\label{eq:e(rho)-bayes}
%\end{align}
%donde $p\qty(\E)=\Tr \qty[\E (\rho)]$ is la probabilidad de que 
%el proceso descrito por $\E$ suceda en alguna entrada de $\rho$.
%Por la regla de Bayes,
%\begin{align}
%	p\qty(i\vert \E)=p\qty(\E \vert i) \frac{p_i}{p\qty(\E)}
%	=\frac{\Tr \qty[\E (\rho)]p_i}{p\qty(\E)},
%\end{align}
%de manera que \eqref{eq:e(rho)-bayes} se reduce a \eqref{eq:qtmOp-a2}.
%
%La tercera propiedad se origina de que no sólo $\E (\rho)$ debe ser
%una matriz de densidad válida tanto cuánto $\rho$ sea válida, pero 
%además, si $\rho _{RQ}$ es la matriz de densidad de un sistema 
%de dos partes $R$ y $Q$, si $\E$ actúa sólamente sobre $Q$, 
%entonces $\E(\rho_{RQ})$ debe ser también una matriz de densidad 
%válida del sistema completo. Supongamos que introducimos un sistema 
%$R$ finito dimensional. Sea $\mathbb{1}$ el mapeo identidad sobre
%el sistema $R$. Entonces el mapeo $\mathbb{1}\otimes \E$ debe
%enviar operadores positivos hacia operadores positivos.
%
%El siguiente teorema establece la equivalencia entre este enfoque 
%axiomático y los modelos de sistema-entorno y la representación
%de operadores de suma con el que se comenzó
%la discusión de las operaciones cuánticas:
%\begin{teorema}
%	El mapeo $\E$ satisface los axiomas \textbf{A1}, \textbf{A2} y 
%	\textbf{A3} si y sólo si
%	\begin{align}
%		\E(\rho) = \sum _i E_i\rho E_i^{\dagger},
%	\end{align}
%	para algún conjunto de operadores $\qty{E_i}$ que mapean el espacio
%	de Hilbert de entrada hacia el espacio de Hilbert de salida, y
%	$\sum _kE_k^{\dagger}E_k\leq \mathbb{1}$.
%\end{teorema}

- Introducción hablando de que las operaciones cuánticas sirven 
para describir la dinámica de los sistemas abiertos y una guía al 
lector de qué se viene en este cap. Enfatizar en que el truco es 
considerar como 'nuevo sistema cerrado' al sistema extendido
\cpnote{No entiendo esa frase}
\janote{Me refiero a que un sistema que interactúa con su entorno es abierto, 
pero si consideramos al sistema total (principal+entorno) ese es cerrado.
\textbf{Ahora que lo expliqué ya no encuentro sentido para hablar de esto aquí,
mejor lo voy a quitar}}
\section{Mapeos completamente positivos}
%\janote{
%Introducir la transformación de la matriz de densidad $\rho$ y hablar
%de que $\E$ transforma estados en estados.}
%
%\janote{
%    - Motivación de la CP. Ejemplo del mapeo que deforma la esfera de Bloch
%    en un disco: presentar que el mapeo extendido para 2 qubits
%    aplicado al estado máximamente entrelazado resulta en una matriz 
%    no positiva (algo que no es estado).}

La completa positividad es una condición que deben satisfacer las operaciones
cuánticas para representar una evolución física 
\cite{bengtsson_zyczkowski_2017}. Esta condición es
intrínseca de la dinámica de los sistemas cuánticos abiertos, dada la 
posibilidad de un sistema cuántico a interaccionar con su entorno. A
continuación, vamos a presentar un ejemplo que justificará la condición
de completa positividad de las operaciones cuánticas y, seguidamente,
vamos a finalizar con la definición precisa de esta condición.

En el formalismo de las operaciones cuánticas, un estado cuántico
descrito por su operador de densidad $\rho$
se transforma según la ecuación \cite{nielsen_chuang_2011}
%\janote{Arreglar, muy de putazo escupo la transformación}
\begin{align}
\rho' = \E (\rho)
\label{eq:E(rho)},
\end{align} 
donde $\E$ es una operación cuántica que representa alguna evolución 
física y $\rho'$ es el estado que resulta de la evolución. 
En el capítulo anterior hemos 
establecido dos ejemplos de operaciones cuánticas, la evolución unitaria 
y la medición del estado de un sistema, 
para los cuales $\E \qty(\rho)=U\rho U^{\dagger}$ y 
$\E(\rho)=M\rho M^{\dagger}$, respectivamente. 
Una operación cuántica proporciona
una descripción discreta del cambio dinámico que un estado cuántico 
atraviesa durante un proceso físico. Una operación cuántica $\E$ es
una transformación lineal que mapea matrices de densidad en matrices 
de densidad \cite{bengtsson_zyczkowski_2017}. Surge entonces la siguiente
pergunte, ¿ser un mapeo afín es
suficiente para asegurar que $\E$ representa una operación física?
A continuación veremos que no.  Para que $\E$ sea una operación física 
debe ser un mapeo afín de operadores de densidad 
y satisfacer la condición de completa positividad. Esta condición
adicional surge como consecuencia del acoplo que el sistema de estudio
pueda tener con un entorno del cual podríamos o no tener acceso a sus
grados de libertad.


Veamos a continuación un ejemplo de una operación que actúa sobre 
un sistema de 1 qubit; y luego, al considerar la misma operación, pero en 
el espacio extendido de 2 qubits, sobre
el estado máximamente entrelazado, 
el resultado de la operación será algo que no es un estado cuántico. 
De esta manera, quedará claro la razón para exigir la condición de 
completa positividad para que una operación cuántica 
represente a un proceso físico.
Consideremos un 1 qubit, un sistema cuántico
de dos niveles, cuya matriz de densidad se puede representar como
\cite{nielsen_chuang_2011}
\begin{align}
\rho=\frac{\1+\vec{r}\cdot\vec{\sigma}}{2},
\label{eq:DM-1q}
\end{align}
donde $\vec{\sigma}$ es un vector con las matrices de Pauli 
en sus entradas y $\vec{r}$
el vector de Bloch ($\abs{\vec{r}}\leq1$). Esta representación
de la matriz de densidad nos permite asociar a cada punto en la 
esfera unitaria con un estado de 1 qubit, como se muestra en la parte
izquierda de \Fref{fig:qtm-op-motivation}. Los estados puros se corresponden
con puntos en la superficie de la esfera y los estados mixtos 
con puntos en el interior, incluyendo al origen.
Ahora consideremos la operación $\E_z$ que deforma la bola de Bloch a un 
disco sobre el plano XY, como se muestra en la \Fref{fig:qtm-op-motivation}. 
La acción de la operación $\E_z$ sobre una matriz de densidad
de la forma \eqref{eq:DM-1q} es transformar al vector de Bloch $\vec{r}$
como $\qty(r_1,r_2,r_3)\mapsto\qty(r_1,r_2,0)$.
\begin{figure}[H]
\centering
\begin{minipage}{.4\textwidth}
\centering
\includegraphics[width=5cm]
{img-congreso/bloch.png}
\end{minipage}
$\stackrel{\E_{z}\otimes\1 \vspace{1cm}}{\longmapsto}$
\begin{minipage}{0.4\textwidth}
\centering
\includegraphics[width=6cm]
{img-congreso/DiskXY}
\end{minipage}
\caption{Deformación de la esfera de Bloch a un disco sobre el plano $XY$.}
\label{fig:qtm-op-motivation}
\end{figure}
Por otro lado, el estado máximente entralazado $\rho^{\phi}$ de 
un sistema de 2 qubits es \cite{bengtsson_zyczkowski_2017}
\begin{align}
\rho^{\phi}&=
\mqty( 
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
).
\label{eq:DM-2q-MaxE}
\end{align}
Siguiendo la representación de la matriz de densidad de 1 qubit,
la matriz de densidad de 2 qubits se puede escribir como
\begin{align}
\rho&=\frac{1}{4}\sum _{i,j=0}^{3}r_{ij}\sigma_i\otimes\sigma_j,
\label{eq:DM-2q}
\end{align}
donde $\sigma_0=\1$ y $\vec{r}$ es un vector de 16 entradas que contiene
la información física local de cada qubit y las correlaciones del sistema.
%\janote{por qué se iguala?}
Se igualan \eqref{eq:DM-2q-MaxE} y \eqref{eq:DM-2q} para encontrar
el estado máximamente entrelazado en la representación de \eqref{eq:DM-2q}. 
Se obtiene que $r_{00}=r_{11}=r_{33}=1$, $r_{22}=-1$, y el resto de 
componentes en $\vec{r}$ son iguales a cero. 

Ahora consideremos la operación $\E_z\otimes\1$ que borra
la componente en $z$ del primer qubit y deja invariante 
al segundo qubit. La acción de esta operación es equivalente 
a transformar el vector $\vec{r}$ de $\rho^{\phi}$, en la representación
de \eqref{eq:DM-2q}, como
\begin{align}
\qty(1,0,0,0,0,1,0,0,0,0,-1,0,0,0,0,1)
\longmapsto
\qty(1,0,0,0,0,1,0,0,0,0,-1,0,0,0,0,0).
\end{align}
Por consiguiente, la matriz de densidad $\rho^{\phi}$ se transforma 
ante la operación $\E_z\otimes\1$ como
\begin{align}
\mqty( 
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
)
%\E\otimes\1\qty(\rho^{\phi})&=
\stackrel{\E_{z}\otimes\1}{\longmapsto}
\mqty( 
\frac{1}{4} & 0 & 0 & \frac{1}{2} \\
0 & \frac{1}{4} & 0 & 0 \\
0 & 0 & \frac{1}{4} & 0 \\
\frac{1}{2} & 0 & 0 & \frac{1}{4} \\
).
\end{align}
La matriz $\E_z\otimes\1\qty(\rho^{\phi})$ tiene un autovalor igual a $-1/4$.
Por consiguiente, $\E_z\otimes\1\qty(\rho^{\phi})$ no es una matriz 
de densidad. Dicho de otro modo, $\E_z\otimes\1\qty(\rho^{\phi})$ 
no describe a algún estado físico de un sistema de 2 qubits.
En resumen, hemos probado que la operación $\E_z$ que deforma la bola 
de Bloch a un disco sobre el plano $XY$, cuando se considera su 
extensión sobre el espacio de 2 qubits $\E_z\otimes\1$ y se aplica al
estado máximamente entrelazado da como resultado un estado no físico. 
En consecuencia, $\E_z$ no representa ninguna evolución física. Este 
resultado deja en evidencia que una operación cuántica debe ser 
un mapeo afín de estados cuánticos, de un sistema que se compone del
sistema principal y otro secundario, sin importar la dimensión del
espacio secundario.

%\janote{- Definición de CP del Geometry of Quantum States.}

Revisemos ahora la definición formal de completa positividad.
Una operación $\E$ se dice que es completamente positiva (CP)
si y sólo si, para cualquier extensión dimensional arbitraria $K$ 
del espacio de Hilbert, tal que 
$\hi_N \rightarrow \hi_N \otimes \hi_K$,
el operador $\E\otimes\1_K$ es positivo semidefinido 
\cite{bengtsson_zyczkowski_2017}. Esta es la última condición 
necesaria de imponer sobre las operaciones cuánticas para 
que sean transformaciones de estados físicos. 

%\janote{- Concluir con que las operaciones que estudiamos deben ser CPTP.}

En conclusión, una operación cuántica es una mapeo afín de 
operadores de densidad que es completamente positivo. 
En la literatura se suele hacer una diferencia entre operaciones cuánticas
y canales cuánticos \cite{weedbrook2012gaussian}, el término operaciones 
cuánticas se utiliza para operaciones que, en general, disminuyen la traza 
del operador de densidad, y canales cuánticos es exclusivo para operaciones 
que preservan la traza del operador de densitad (operaciones CPTP). En 
este proyecto estamos interesados en estudiar las operaciones CPTP. 
En las siguientes dos secciones vamos a presentar dos representaciones
distintas de las operaciones CPTP. 



\section{Superoperadores}
\janote{Propongo agregar esta sección por la línea que quiero seguir 
durante todo el capítulo. Además que si menciono la representación en 
suma de operadores, por qué no la de superoperadores?  es la que he 
usado para la parte numérica}

Una forma de representar a las operaciones cuánticas es la forma de 
superoperadores. Un superoperador es una transformación lineal
que actúa sobre el espacio vectorial de los operadores lineales 
\cite{preskill1998lecture}. Iniciaremos esta sección discutiendo algunas
transformaciones algebraicas sobre matrices e introduciremos 
una notación de cuatro índices para trabajar en un espacio de Hilbert 
compuesto por dos subsistemas. Luego, vamos a presentar 
las condiciones que debe satisfacer un superoperador para ser un 
canal cuántico. Por último vamos a presentar dos ejemplos de operaciones
lineales que actúan sobre el operador de densidad de 1 qubit. En el primer 
ejemplo vamos a retomar la operación discutida en la sección anterior y, 
utilizando su representación de superoperador, vamos a mostrar que no es CP. 
En el segundo discutiremos una operación CP sobre la esfera de Bloch. 

%- Empezar hablando del reshape a $\rho$ (pasarlo de matriz a vector columna)
En la forma de superoperadores de las operaciones cuánticas se 
considera que el superoperador actúa sobre
un vector columna, por lo cual es necesario estudiar alguna transformación
lineal que reordene una matriz en un vector columna, y viceversa.
Consideremos una matriz rectangular $A$ de dimensión $M\times N$.
La matriz puede reordenarse colocando sus elementos de matriz en 
orden lexicográfico en un vector $\vec{a}$ con $MN$ elementos, es decir
\begin{align}
a_k=A_{ij}, 
\label{eq:matrix-to-vector}
\end{align}
donde $k=\qty(i-1)N+j$, con $i=,1,\ldots,M$ y $j=1,\ldots,N$. De
esta manera, es posible reordenar a la matriz de densidad como un 
vector columna. Ante esta transformación los elementos de matriz no se 
modifican, por lo cual la información física contenida en una matriz 
de densidad tampoco se altera.

Para determinar si una operación lineal, en su forma de superoperador, es CP 
se evalúa la positividad semidefinida del superoperador
reordenado según el procedimiento de \textit{reshuffle}.
La transformación de \textit{reshuffle} $R$ de una matriz cuadrada $B$ 
consiste en reordenar cada fila de $B$, con $MN$ elementos, 
en submatrices de dimensión $M\times N$ y colocarlas en 
orden lexicográfico bloque por bloque. Veamos un ejemplo del 
\textit{reshuffle} de una matriz $B$ de $4\times 4$, en la que 
cada fila se reordena en una submatriz de $2\times 2$
\begin{align}
B=
\mqty(
B_{00}&B_{01}&B_{02}&B_{03}\\
B_{10}&B_{11}&B_{12}&B_{13}\\
B_{20}&B_{21}&B_{22}&B_{23}\\
B_{30}&B_{31}&B_{32}&B_{33})
\stackrel{R}{\longrightarrow}
\mqty(
B_{00}&B_{01}&B_{10}&B_{11}\\
B_{02}&B_{03}&B_{12}&B_{13}\\
B_{20}&B_{21}&B_{30}&B_{31}\\
B_{22}&B_{23}&B_{32}&B_{33})
=B^R.
\label{eq:reshuffle}
\end{align}
Más adelante veremos que la matriz del superoperador 
reordenada según el \textit{reshuffle} se define como la matriz de Choi
de la operación lineal.

Para establecer las condiciones que una operación en su
representación de superoperador debe cumplir para ser un mapeo afín de
operadores de densidad es útil introducir la siguiente notación de cuatro índices. 
Supongamos que $U$ es un operador que actúa sobre un espacio de Hilbert 
compuesto de la forma $\hi=\hi_M\otimes\hi_N$.
Sea $\ket{i}$ una base ortonormal de $\hi_M$ y $\ket{\mu}$ una base
ortonormal de $\hi_N$. Nótese el uso de letras latinas para los índices del
primer subsistema y letras griegas para los índices del segundo.
El producto tensorial $\ket{i}\otimes\ket{\mu}$
es una base del espacio compuesto $\hi$. Por lo tanto, un 
elemento de matriz de $U$, utilizando cuatro índices, es
\begin{align}
U_\ind{m\mu}{n\nu}=\matrixel{i\otimes \mu}{U}{j\otimes \nu}.
\label{eq:4indices}
\end{align}
\janote{Hablar de los mapeos que actúan sobre $\rho$ como un vector columna}

Hasta ahora lo que hemos expuesto nos permite reordenar a una matriz
de densidad $\rho$ de dimensión $N\times N$ en un vector con $N^2$ 
elementos. Por consiguiente, la representación matricial de un 
superoperador $\E$ que actúa sobre un operador de densidad vectorizado $\vec{\rho}$ 
debe ser de dimensión $N^2\times N^2$. Los elementos de matriz de
$\E$ pueden etiquetarse utilizando cuatro índices como en \eqref{eq:4indices}
haciendo cualquier partición en dos del sistema total.

Una operación $\E$ que sea candidato a canal cuántico debe transformar 
operadores de densidad en operadores de densidad. Esto quiere decir que
la imagen $\rho'$ del operador de densidad debe ser Hermítica, 
de traza unitaria y positiva semidefinida. 
Cada una de estas condiciones sobre $\rho'$ impone una condición 
sobre el superoperador $\E$:
\begin{align}
\txt{(i)}&& \rho'=\qty(\rho')^{\dagger}&&\Leftrightarrow
    && \E_\ind{m\mu}{n\nu}=\E_\ind{\mu m}{\nu n}^*,&&
    \label{eq:H-condition}\\
\txt{(ii)}&&\Tr(\rho')=1
    &&\Leftrightarrow&&  \E_\ind{mm}{n\nu}=\delta_{n\nu},\\     
\txt{(iii)}&&\rho'\geq1
    &&\Leftrightarrow&&  \E_\ind{m\mu}{n\nu}\rho_{n\nu}\geq0.
    \label{eq:positivity-condition}
\end{align}


\janote{
- Hablar de la matriz de Choi y enunciar el teorema de Choi: si la matriz
 de Choi es positiva semidefinida entonces la operación cuántica es CP
}

Según lo que discutimos en la sección anterior estas condiciones
no son suficientes para que $\E$ sea un canal cuántico; adicionalmente 
$\E$ debe ser CP. Para evaluar la completa positividad del superoperador $\E$ 
vamos a definir la matriz de Choi $D_{\E}$ como 
\cite{bengtsson_zyczkowski_2017}
\begin{align}
D_{\E}=\E^{R}.
\end{align}
La matriz de Choi de $\E$ es la matriz que resulta del \textit{reshuffle}
de $\E$. Con la matriz de Choi $D_{\E}$ definida vamos a enunciar 
el teorema de Choi \cite{bengtsson_zyczkowski_2017} que
establece si $\E$ es CP evaluando la positividad semidefinida de $D_{\E}$.
\begin{teorema}
Una transformación lineal $\E$ es completamente positiva si y sólo si 
su matriz de Choi asociada $D_{\E}$ es positiva semidefinida.
\end{teorema}
Este teorema completa las herramientas para establecer el procedimiento 
para evaluar si un superoperador $\E$ es un canal cuántico. 
Dado que $\E$ cumple con las condiciones establecidas en
\eqref{eq:H-condition} a \eqref{eq:positivity-condition}, la positividad
de la matriz de Choi $D_{\E}$ determina si la operación es un canal cuántico.

\janote{
- Concluir con un ejemplo de un canal nuestro sobre 1 qubit
}

Retomemos el ejemplo de la operación $\E_z$ sobre 1 qubit de la sección anterior
que se ilustra en la \Fref{fig:qtm-op-motivation}. La ecuación \eqref{eq:E(rho)}
de la transformación del operador de densidad por un canal cuántico, 
considerando al superoperador $\E_z$ y a la matriz de densidad 
$\rho$ de 1 qubit, en \eqref{eq:DM-1q}, como un vector según la ecuación 
\eqref{eq:matrix-to-vector}, es 
\begin{align}
\mqty(
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
)
\frac{1}{2}
\mqty(
1+r_z\\r_x-ir_y\\r_x+ir_y\\1-r_z
)
=
\frac{1}{2}´
\mqty(
1\\r_x-ir_y\\r_x+ir_y\\1
)
\end{align}
Se calcula la matriz de Choi $\E_z^{R}$, siguiendo la ecuación
\eqref{eq:DM-1q},
\begin{align}
\E_z^R=
\mqty(
\frac{1}{2} & 0 & 0 & 1 \\
0 & \frac{1}{2} & 0 & 0 \\
0 & 0 & \frac{1}{2} & 0 \\
1 & 0 & 0 & \frac{1}{2} 
).
\end{align}
La matriz $\E_z^R$ tiene un autovalor $-1/2$, por ello $\E_z$ no es CP y,
por consiguiente, no es un canal cuántico. Nótese que hemos llegado a la misma 
conclusión de la sección pasada sobre la CP, pero utilizando la representación 
de superoperador de $\E_z$.

\janote{Otro ejemplo, pero ahora sí de un canal}

Para concluir la sección será útil desarrollar un ejemplo más 
de una operación CP sobre un sistema de 1 qubit. Este 
ejemplo servirá para proporcionar más familiaridad con la representación de 
los superoperadores y para hacer la conexión con 
la forma de Kraus de las operaciones CP en la siguiente sección.

Consideremos la operación $\E_{xz}$ que colapsa la esfera de Bloch de 
un sistema de 1 qubit al eje $y$, como se muestra en la \Fref{fig:QC-ex2}.
\begin{figure}[H]
    \centering
    \begin{minipage}{.4\textwidth}
        \centering
        \includegraphics[width=5cm]
        {img-congreso/bloch.png}
    \end{minipage}
    $\stackrel{\E_{xz}\otimes\1 \vspace{1cm}}{\longmapsto}$
    \begin{minipage}{0.4\textwidth}
        \centering
        \includegraphics[width=6cm]
        {img-congreso/lineY}
    \end{minipage}
    \caption{Deformación de la esfera de Bloch a un disco sobre el plano $XY$.}
    \label{fig:QC-ex2}
\end{figure}
La transformación de los estados de 1 qubit en la esfera de Bloch 
según la operación $\E_{xz}$ está descrita por la siguiente ecuación
\begin{align}
\mqty(
\begin{array}{cccc}
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
0 & \frac{1}{2} & -\frac{1}{2} & 0 \\
0 & -\frac{1}{2} & \frac{1}{2} & 0 \\
\frac{1}{2} & 0 & 0 & \frac{1}{2} \\
\end{array}
)
\frac{1}{2}
\mqty(
1+r_z\\r_x-ir_y\\r_x+ir_y\\1-r_z
)
=
\frac{1}{2}
\mqty(
1\\-ir_y\\ir_y\\1
),
\label{eq:QC-ex2-SR}
\end{align}
donde la matriz es el superoperador $\E_{xz}$. 
Para comprobar si la matriz en \eqref{eq:QC-ex2-SR} es CP debemos 
determinar $\E_{xz}^R$ y verificar si es
es positiva semidefinida. Notemos que $\E_{xz}^R=\E_{xz}$, por lo tanto, 
$\E_{xz}$ es CP y, porque además satisface las condiciones
\eqref{eq:H-condition} a \eqref{eq:positivity-condition}, es un canal cuántico.

En resumen, la representación en superoperador de una operación cuántica
se trata de reordenar la matriz de densidad $\rho$ como 
un vector columna y considerar la transformación que actúa sobre el nuevo
vector $\vec{\rho}$. Si un operación $\E$ satisface las condiciones
\eqref{eq:H-condition} a \eqref{eq:positivity-condition}, entonces
es un mapeo afín de matrices de densidad.
Por otro lado, el procedimiento de \textit{reshuffle} 
nos proporciona un procedimiento para calcular la matriz de Choi de una 
operación $\E$. Seguidamente, el teorema de Choi establece que si 
la matriz de Choi es positiva semidefinida, entonces $\E$ es CP. 
De esta manera, hemos establecido las herramientas para evaluar 
si una operación en su forma de superoperador es un canal cuántico.
En la siguiente sección discutiremos otra forma de representar a las operaciones
cuánticas.

\section{Forma de Kraus}
- Enunciar la representación en operadores de suma partiendo de un 
estado que se acopla con algún entorno
y llegar a las condiciones para ser CPTP y empezar a conectarlo
con la sección anterior. \cpnote{No sabes si hay alguna motivacion que no sea
con el entorno? Realmente no lo usamos y se me hace meter una complicación adicional}
\janote{De acuerdo. Voy a omitir la motivación con el entorno.}

\janote{Intro:}
Las operaciones cuánticas tienen otra representación distinta a la de 
los superoperadores que se conoce como la forma de Kraus. La diferencia
principal entre ambas representaciones es que la forma de los superoperadores
considera operadores que actúan sobre el espacio de los operadores lineales, y
la forma de Kraus considera operadores que actúan sobre el espacio de 
Hilbert del sistema. Vamos a iniciar retomando el segundo ejemplo de la sección 
anterior en el cual se consideró la operación $\E_{xz}$, representada
en la \ref{}, para presentar la forma de Kraus de ese canal cuántico y 
al mismo tiempo hacer la conexión entre la representación de superoperadores
y de la forma de Kraus. Para concluir vamos a exponer las condiciones 
de la forma de Kraus para representar a un canal cuántico.

\janote{
- Invocar el ejemplo del canal de la sección anterior, pero en su 
representación de operadores de suma. Aquí quiero hacer la conexión 
entre esta y la sección anterior mostrando que los operadores 
de Kraus son los autovectores de la matriz de Choi.}

Regresemos al segundo ejemplo del canal cuántico $\E_{xz}$ que consideramos 
en la seccción anterior. El canal $\E_{xz}$ deforma la esfera de Bloch
a una línea sobre el eje $y$, como se muestra en la \Fref{}. 
Recordemos que la matriz en \eqref{eq:QC-ex2-SR} es el canal cuántico
y a la vez su matriz de Choi ($\E_{xz}^R=\E_{xz}$). 
Consideremos los autovectores $\ket{E_{1,2,3,4}}$ de la matriz de Choi
\begin{align}
\ket{E_{1,2,3,4}}=
\mqty(\frac{1}{2},0,0,\frac{1}{2})^T,
\mqty(0,-\frac{1}{2},\frac{1}{2},0)^T,
\mqty(-\frac{1}{2},0,0,\frac{1}{2})^T,
\mqty(0,\frac{1}{2},\frac{1}{2},0)^T;
\end{align}
cuyos autovalores son $\lambda_{1,2,3,4}=1,1,0,0$, respectivamente.
Tomemos a $\ket{E_1}$ y $\ket{E_2}$, los únicos autovectores
con autovalores distintos de cero, y los reordenamos en 
las matrices $E_1$ y $E_2$, de dimensión $2\times2$, siguiendo 
el procedimiento inverso de \eqref{eq:matrix-to-vector}
\begin{align}
E_1&=
\mqty(
\frac{1}{2} & 0\\
0 & \frac{1}{2}
)
&
E_2&=
\mqty(
0 & -\frac{1}{2}\\
\frac{1}{2} & 0
).
\end{align}
Ahora hagamos la siguiente operación
\begin{align}
\sum_{i=1}^2E_i\rho E_i^{\dagger}=\rho',
\label{eq:almost-Kraus}
\end{align}
con $\rho$ la matriz de densidad de 1 qubit en \eqref{eq:DM-1q}, entonces
\begin{align}
\rho'=&
\mqty(
\frac{1}{2} & 0\\
0 & \frac{1}{2}
)
\mqty(
\frac{1+r_z}{2}& \frac{r_x-ir_y}{2}\\
\frac{r_x+ir_y}{2} & \frac{1-r_z}{2}
)
\mqty(
\frac{1}{2} & 0\\
0 & \frac{1}{2}
)
+
\mqty(
0 & -\frac{1}{2}\\
\frac{1}{2} & 0
)´
\mqty(
\frac{1+r_z}{2}& \frac{r_x-ir_y}{2}\\
\frac{r_x+ir_y}{2} & \frac{1-r_z}{2}
)
\mqty(
0 & \frac{1}{2}\\
-\frac{1}{2} & 0
)&
\nonumber\\
\rho'=&
\frac{1}{2}´
\mqty(
1 & -ir_y\\
ir_y & 1
).
\label{eq:QC-ex2-KR}
\end{align}
Este resultado es el mismo que obtuvimos en la ecuación \eqref{eq:QC-ex2-SR},
pero llegamos a él considerando los operadores $E_1$ y $E_2$ que actúan
sobre el espacio de Hilbert de un sistema de 1 qubit.
La ecuación \eqref{eq:almost-Kraus} se conoce 
como la forma de \textit{Kraus} de los mapeos CP.
Los autovectores de la matriz de Choi reordenados como matrices son los 
operadores de Kraus. En general,
se dice que un mapeo es completamente positivo si y sólo si es de la forma
\cite{bengtsson_zyczkowski_2017}
\begin{align}
\rho \rightarrow \rho'=\sum_iE_i\rho E_i^{\dagger},
\label{eq:kraus-def}
\end{align}
donde los operadores de Kraus linealmente independientes 
pueden ser hasta $N^2$ \cite{nielsen_chuang_2011}, igual a la dimensión 
del espacio de los operadores lineales que actúan sobre el espacio de
Hilbert de un sistema de dimensión $N$. Se dice que una operación cuántica
$\E$ de la forma \eqref{eq:kraus-def} preserva la traza (operación CPTP) 
si y sólo los operadores de Kraus satisfacen la condición 
\cite{bengtsson_zyczkowski_2017}
\begin{align}
\sum_iE_i^{\dagger}E_i=\1.
\label{eq:kraus-tp-cond}
\end{align}
En resumen, las ecuaciones \eqref{eq:kraus-def} y \eqref{eq:kraus-tp-cond}
establecen las condiciones que deben satisfacer las operaciones CPTP en la 
forma de Kraus. 

\janote{
- Comparar la representacion de suma de operadores y superoperadores}

%Las ecuaciones \eqref{eq:QC-ex2-SR} y \eqref{eq:QC-ex2-KR} representan
%en dos formas distintas la acción del mismo canal cuántico  
%sobre el estado de un sistema de 1 qubit.
Hasta ahora hemos mostrado dos formas distintas de representar una 
operación cuántica, la representación de superoperadores y de la forma 
de Kraus. Ambas representaciones equivalentes. Una operación 
cuántica puede representarse de cualquiera de las dos formas. Dependiendo
el enfoque de un problema se hace más conveniente una representación 
o la otra. Más adelante veremos que para el objetivo de este proyecto
la representación de superoperadores será más útil. 

\janote{No me parece necesario entrar en detalle con la forma de Kraus.
Quizás las demostraciones y más detalle se pueden guardar para la tesis.
Espero haber logrado dar una buena motivación de la CP y haber conectado
bien la forma de Kraus con la de superoperadores con los ejemplos.}
\section{Canales cuánticos de 1 qubit}
- Hablar de que se gana intuición pensando en la acción de un canal de 1
qubit como la manera en que deforma la esfera de Bloch

- Ejemplos: phase-flip channel, depolarizing y amplitude damping 

- De los ejemplos hablar sobre canales unitales? Breve. (es que nuestros
canales son unitales)

% }}}

